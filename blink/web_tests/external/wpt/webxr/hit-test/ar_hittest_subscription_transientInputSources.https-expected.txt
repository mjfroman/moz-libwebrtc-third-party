This is a testharness.js-based test.
FAIL Ensures subscription to transient hit test works with an XRSpace from input source - no move promise_test: Unhandled rejection with value: "Session with params \"immersive-ar\" was rejected on device {\"supportedModes\":[\"immersive-ar\"],\"views\":[{\"eye\":\"left\",\"projectionMatrix\":[1,0,0,0,0,1,0,0,3,2,-1,-1,0,0,-0.2,0],\"viewOffset\":{\"position\":[-0.1,0,0],\"orientation\":[0,0,0,1]},\"resolution\":{\"width\":200,\"height\":200}},{\"eye\":\"right\",\"projectionMatrix\":[1,0,0,0,0,1,0,0,3,2,-1,-1,0,0,-0.2,0],\"viewOffset\":{\"position\":[0.1,0,0],\"orientation\":[0,0,0,1]},\"resolution\":{\"width\":200,\"height\":200}}],\"floorOrigin\":{\"position\":[0,-0.25,0],\"orientation\":[0,0,0,1]},\"viewerOrigin\":{\"position\":[0,1,0],\"orientation\":[0,0,0,1]},\"supportedFeatures\":[\"viewer\",\"local\",\"local-floor\",\"bounded-floor\",\"unbounded\",\"hit-test\",\"dom-overlay\",\"light-estimation\"],\"world\":{\"hitTestRegions\":[{\"type\":\"plane\",\"faces\":[{\"vertices\":[{\"x\":-2.5,\"y\":0,\"z\":-2.5,\"w\":1},{\"x\":2.5,\"y\":0,\"z\":-2.5,\"w\":1},{\"x\":2.5,\"y\":2,\"z\":-2.5,\"w\":1}]},{\"vertices\":[{\"x\":-2.5,\"y\":0,\"z\":-2.5,\"w\":1},{\"x\":2.5,\"y\":2,\"z\":-2.5,\"w\":1},{\"x\":-2.5,\"y\":2,\"z\":-2.5,\"w\":1}]},{\"vertices\":[{\"x\":-2.5,\"y\":0,\"z\":-2.5,\"w\":1},{\"x\":2.5,\"y\":0,\"z\":-2.5,\"w\":1},{\"x\":2.5,\"y\":0,\"z\":2.5,\"w\":1}]},{\"vertices\":[{\"x\":-2.5,\"y\":0,\"z\":-2.5,\"w\":1},{\"x\":-2.5,\"y\":0,\"z\":2.5,\"w\":1},{\"x\":2.5,\"y\":0,\"z\":2.5,\"w\":1}]}]},{\"type\":\"mesh\",\"faces\":[{\"vertices\":[{\"x\":-2.5,\"y\":0,\"z\":-2.5,\"w\":1},{\"x\":-2.5,\"y\":2,\"z\":-2.5,\"w\":1},{\"x\":-2.5,\"y\":2,\"z\":2.5,\"w\":1}]},{\"vertices\":[{\"x\":-2.5,\"y\":0,\"z\":-2.5,\"w\":1},{\"x\":-2.5,\"y\":0,\"z\":2.5,\"w\":1},{\"x\":-2.5,\"y\":2,\"z\":2.5,\"w\":1}]},{\"vertices\":[{\"x\":2.5,\"y\":0,\"z\":-2.5,\"w\":1},{\"x\":2.5,\"y\":2,\"z\":-2.5,\"w\":1},{\"x\":2.5,\"y\":2,\"z\":2.5,\"w\":1}]},{\"vertices\":[{\"x\":2.5,\"y\":0,\"z\":-2.5,\"w\":1},{\"x\":2.5,\"y\":0,\"z\":2.5,\"w\":1},{\"x\":2.5,\"y\":2,\"z\":2.5,\"w\":1}]}]},{\"type\":\"point\",\"faces\":[{\"vertices\":[{\"x\":-2.5,\"y\":2,\"z\":-2.5,\"w\":1},{\"x\":2.5,\"y\":2,\"z\":-2.5,\"w\":1},{\"x\":2.5,\"y\":2,\"z\":2.5,\"w\":1}]},{\"vertices\":[{\"x\":-2.5,\"y\":2,\"z\":-2.5,\"w\":1},{\"x\":-2.5,\"y\":2,\"z\":2.5,\"w\":1},{\"x\":2.5,\"y\":2,\"z\":2.5,\"w\":1}]}]}]}} with error: NotSupportedError: Failed to execute 'requestSession' on 'XRSystem': No XR hardware found."
FAIL Ensures subscription to transient hit test works with an XRSpace from input source - after move - no results promise_test: Unhandled rejection with value: "Session with params \"immersive-ar\" was rejected on device {\"supportedModes\":[\"immersive-ar\"],\"views\":[{\"eye\":\"left\",\"projectionMatrix\":[1,0,0,0,0,1,0,0,3,2,-1,-1,0,0,-0.2,0],\"viewOffset\":{\"position\":[-0.1,0,0],\"orientation\":[0,0,0,1]},\"resolution\":{\"width\":200,\"height\":200}},{\"eye\":\"right\",\"projectionMatrix\":[1,0,0,0,0,1,0,0,3,2,-1,-1,0,0,-0.2,0],\"viewOffset\":{\"position\":[0.1,0,0],\"orientation\":[0,0,0,1]},\"resolution\":{\"width\":200,\"height\":200}}],\"floorOrigin\":{\"position\":[0,-0.25,0],\"orientation\":[0,0,0,1]},\"viewerOrigin\":{\"position\":[0,1,0],\"orientation\":[0,0,0,1]},\"supportedFeatures\":[\"viewer\",\"local\",\"local-floor\",\"bounded-floor\",\"unbounded\",\"hit-test\",\"dom-overlay\",\"light-estimation\"],\"world\":{\"hitTestRegions\":[{\"type\":\"plane\",\"faces\":[{\"vertices\":[{\"x\":-2.5,\"y\":0,\"z\":-2.5,\"w\":1},{\"x\":2.5,\"y\":0,\"z\":-2.5,\"w\":1},{\"x\":2.5,\"y\":2,\"z\":-2.5,\"w\":1}]},{\"vertices\":[{\"x\":-2.5,\"y\":0,\"z\":-2.5,\"w\":1},{\"x\":2.5,\"y\":2,\"z\":-2.5,\"w\":1},{\"x\":-2.5,\"y\":2,\"z\":-2.5,\"w\":1}]},{\"vertices\":[{\"x\":-2.5,\"y\":0,\"z\":-2.5,\"w\":1},{\"x\":2.5,\"y\":0,\"z\":-2.5,\"w\":1},{\"x\":2.5,\"y\":0,\"z\":2.5,\"w\":1}]},{\"vertices\":[{\"x\":-2.5,\"y\":0,\"z\":-2.5,\"w\":1},{\"x\":-2.5,\"y\":0,\"z\":2.5,\"w\":1},{\"x\":2.5,\"y\":0,\"z\":2.5,\"w\":1}]}]},{\"type\":\"mesh\",\"faces\":[{\"vertices\":[{\"x\":-2.5,\"y\":0,\"z\":-2.5,\"w\":1},{\"x\":-2.5,\"y\":2,\"z\":-2.5,\"w\":1},{\"x\":-2.5,\"y\":2,\"z\":2.5,\"w\":1}]},{\"vertices\":[{\"x\":-2.5,\"y\":0,\"z\":-2.5,\"w\":1},{\"x\":-2.5,\"y\":0,\"z\":2.5,\"w\":1},{\"x\":-2.5,\"y\":2,\"z\":2.5,\"w\":1}]},{\"vertices\":[{\"x\":2.5,\"y\":0,\"z\":-2.5,\"w\":1},{\"x\":2.5,\"y\":2,\"z\":-2.5,\"w\":1},{\"x\":2.5,\"y\":2,\"z\":2.5,\"w\":1}]},{\"vertices\":[{\"x\":2.5,\"y\":0,\"z\":-2.5,\"w\":1},{\"x\":2.5,\"y\":0,\"z\":2.5,\"w\":1},{\"x\":2.5,\"y\":2,\"z\":2.5,\"w\":1}]}]},{\"type\":\"point\",\"faces\":[{\"vertices\":[{\"x\":-2.5,\"y\":2,\"z\":-2.5,\"w\":1},{\"x\":2.5,\"y\":2,\"z\":-2.5,\"w\":1},{\"x\":2.5,\"y\":2,\"z\":2.5,\"w\":1}]},{\"vertices\":[{\"x\":-2.5,\"y\":2,\"z\":-2.5,\"w\":1},{\"x\":-2.5,\"y\":2,\"z\":2.5,\"w\":1},{\"x\":2.5,\"y\":2,\"z\":2.5,\"w\":1}]}]}]}} with error: NotSupportedError: Failed to execute 'requestSession' on 'XRSystem': No XR hardware found."
FAIL Ensures subscription to transient hit test works with an XRSpace from input source - after move - 1 result promise_test: Unhandled rejection with value: "Session with params \"immersive-ar\" was rejected on device {\"supportedModes\":[\"immersive-ar\"],\"views\":[{\"eye\":\"left\",\"projectionMatrix\":[1,0,0,0,0,1,0,0,3,2,-1,-1,0,0,-0.2,0],\"viewOffset\":{\"position\":[-0.1,0,0],\"orientation\":[0,0,0,1]},\"resolution\":{\"width\":200,\"height\":200}},{\"eye\":\"right\",\"projectionMatrix\":[1,0,0,0,0,1,0,0,3,2,-1,-1,0,0,-0.2,0],\"viewOffset\":{\"position\":[0.1,0,0],\"orientation\":[0,0,0,1]},\"resolution\":{\"width\":200,\"height\":200}}],\"floorOrigin\":{\"position\":[0,-0.25,0],\"orientation\":[0,0,0,1]},\"viewerOrigin\":{\"position\":[0,1,0],\"orientation\":[0,0,0,1]},\"supportedFeatures\":[\"viewer\",\"local\",\"local-floor\",\"bounded-floor\",\"unbounded\",\"hit-test\",\"dom-overlay\",\"light-estimation\"],\"world\":{\"hitTestRegions\":[{\"type\":\"plane\",\"faces\":[{\"vertices\":[{\"x\":-2.5,\"y\":0,\"z\":-2.5,\"w\":1},{\"x\":2.5,\"y\":0,\"z\":-2.5,\"w\":1},{\"x\":2.5,\"y\":2,\"z\":-2.5,\"w\":1}]},{\"vertices\":[{\"x\":-2.5,\"y\":0,\"z\":-2.5,\"w\":1},{\"x\":2.5,\"y\":2,\"z\":-2.5,\"w\":1},{\"x\":-2.5,\"y\":2,\"z\":-2.5,\"w\":1}]},{\"vertices\":[{\"x\":-2.5,\"y\":0,\"z\":-2.5,\"w\":1},{\"x\":2.5,\"y\":0,\"z\":-2.5,\"w\":1},{\"x\":2.5,\"y\":0,\"z\":2.5,\"w\":1}]},{\"vertices\":[{\"x\":-2.5,\"y\":0,\"z\":-2.5,\"w\":1},{\"x\":-2.5,\"y\":0,\"z\":2.5,\"w\":1},{\"x\":2.5,\"y\":0,\"z\":2.5,\"w\":1}]}]},{\"type\":\"mesh\",\"faces\":[{\"vertices\":[{\"x\":-2.5,\"y\":0,\"z\":-2.5,\"w\":1},{\"x\":-2.5,\"y\":2,\"z\":-2.5,\"w\":1},{\"x\":-2.5,\"y\":2,\"z\":2.5,\"w\":1}]},{\"vertices\":[{\"x\":-2.5,\"y\":0,\"z\":-2.5,\"w\":1},{\"x\":-2.5,\"y\":0,\"z\":2.5,\"w\":1},{\"x\":-2.5,\"y\":2,\"z\":2.5,\"w\":1}]},{\"vertices\":[{\"x\":2.5,\"y\":0,\"z\":-2.5,\"w\":1},{\"x\":2.5,\"y\":2,\"z\":-2.5,\"w\":1},{\"x\":2.5,\"y\":2,\"z\":2.5,\"w\":1}]},{\"vertices\":[{\"x\":2.5,\"y\":0,\"z\":-2.5,\"w\":1},{\"x\":2.5,\"y\":0,\"z\":2.5,\"w\":1},{\"x\":2.5,\"y\":2,\"z\":2.5,\"w\":1}]}]},{\"type\":\"point\",\"faces\":[{\"vertices\":[{\"x\":-2.5,\"y\":2,\"z\":-2.5,\"w\":1},{\"x\":2.5,\"y\":2,\"z\":-2.5,\"w\":1},{\"x\":2.5,\"y\":2,\"z\":2.5,\"w\":1}]},{\"vertices\":[{\"x\":-2.5,\"y\":2,\"z\":-2.5,\"w\":1},{\"x\":-2.5,\"y\":2,\"z\":2.5,\"w\":1},{\"x\":2.5,\"y\":2,\"z\":2.5,\"w\":1}]}]}]}} with error: NotSupportedError: Failed to execute 'requestSession' on 'XRSystem': No XR hardware found."
Harness: the test ran to completion.

