// Copyright 2021 The Chromium Authors
// Use of this source code is governed by a BSD-style license that can be
// found in the LICENSE file.

// https://fedidcg.github.io/FedCM/#dictdef-identityproviderconfig

dictionary IdentityProviderConfig {
  // URL for the Identity Provider Configuration.
  USVString configURL;
  USVString clientId;
  USVString nonce;
  DOMString loginHint;
  [RuntimeEnabled=FedCmHostedDomain] DOMString hostedDomain;
  [RuntimeEnabled=FedCmAuthz] sequence<USVString> scope;
  [RuntimeEnabled=FedCmAuthz] sequence<USVString> responseType;
  [RuntimeEnabled=FedCmAuthz] record<USVString, USVString> params;
};

// extends the IdentityProviderConfig with Wallet-specific attributes
partial dictionary IdentityProviderConfig  {
  [RuntimeEnabled=WebIdentityMDocs] MDocProvider holder;
};

dictionary MDocProvider  {
  // A query selector.
  MDocSelector selector;

  // An opaque map of parameters.
  record<USVString, USVString> params;
};

dictionary MDocSelector {
  // A list of desired response types.
  sequence<USVString> format;

  // The top-level type of document (e.g. a passport, driver's license, etc).
  DOMString doctype;

  // Omitting `retention` implies that the identity information will not be stored.
  // How long the verifier intends to retent the credential.
  MDocStorageDuration retention;

  // The requested fields.
  sequence<(MDocElement or DOMString)> fields;
};

dictionary MDocElement {
  required DOMString name;
  DOMString equals;
};

dictionary MDocStorageDuration {
  // Exactly one of the following must be provided.
  boolean forever;
  long days;
};
